# –û—Ç—á–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2024  
**–í–µ—Ä—Å–∏—è:** –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)

## –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:**

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∞ (Zod)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email, –ø–∞—Ä–æ–ª—è, ObjectId, –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ Stack traces –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ production
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω middleware `initUser` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –£–±—Ä–∞–Ω–∞ —É—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ errorHandler - error.message –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ production
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç brute-force –∏ DoS –∞—Ç–∞–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ JSON payload (10mb)
- ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ - —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ production
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `req.user` –≤–º–µ—Å—Ç–æ `req.body.user` —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –£—è–∑–≤–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (0 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π)

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã! ‚úÖ**

---

## –í—ã—Å–æ–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. üü† –í–´–°–û–ö–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ security headers

**–§–∞–π–ª:** `src/server.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ security headers:

- `helmet.js` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç XSS
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç clickjacking
- –ù–µ—Ç HSTS
- –ù–µ—Ç Content Security Policy

**–†–∏—Å–∫:** –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –≤–µ–±-–∞—Ç–∞–∫–∞–º (XSS, clickjacking, MIME sniffing).

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `helmet`:

```typescript
import helmet from 'helmet';

app.use(helmet());
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**

---

## –°—Ä–µ–¥–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 2. üü° –°–†–ï–î–ù–ò–ô: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ timing attacks

**–§–∞–π–ª:** `src/api/auth/services/login.service.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–ª–∏—á–∏–∏ email –≤ —Å–∏—Å—Ç–µ–º–µ.

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**

```typescript
const player = await PlayerModel.findOne({ email });

if (!player) {
  throw createHttpError(401, 'User not found'); // ‚ùå –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç
}
// –î–∞–ª—å—à–µ –∏–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
```

**–†–∏—Å–∫:** Enumeration attack - –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç —É–∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ email –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ.

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Ä–æ–ª—è, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω:

```typescript
const player = await PlayerModel.findOne({ email });
const isValidPassword = player
  ? await verifyPassword(password, player.passwordHash, player.passwordSalt)
  : await verifyPassword(password, '$2b$10$dummy', 'dummy');

if (!player || !isValidPassword) {
  throw createHttpError(401, 'Invalid email or password');
}
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**

---

### 3. üü° –°–†–ï–î–ù–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç CSRF –∞—Ç–∞–∫. –•–æ—Ç—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies –¥–ª—è refresh tokens, –Ω–µ—Ç CSRF —Ç–æ–∫–µ–Ω–æ–≤.

**–†–∏—Å–∫:** CSRF –∞—Ç–∞–∫–∏ –Ω–∞ endpoints, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (POST, PUT, DELETE, PATCH).

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `csurf` middleware:

```typescript
import csrf from 'csurf';

const csrfProtection = csrf({ cookie: true });
app.use('/api', csrfProtection);
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** CSRF –∑–∞—â–∏—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ–π, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Bearer token –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±–µ–∑ cookies. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies –¥–ª—è refresh tokens, CSRF –∑–∞—â–∏—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**

---

### 4. üü° –°–†–ï–î–ù–ò–ô: CORS credentials: false –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ cookies

**–§–∞–π–ª:** `src/server.ts` (—Å—Ç—Ä–æ–∫–∞ 35)

**–ü—Ä–æ–±–ª–µ–º–∞:** `credentials: false`, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies –¥–ª—è refresh tokens. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º —Å CORS.

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**

```typescript
credentials: false, // ‚ùå –ù–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies
```

**–†–∏—Å–∫:** Cookies –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å CORS.

**–†–µ—à–µ–Ω–∏–µ:** –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `credentials: true`:

```typescript
credentials: true, // –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `credentials: true` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `origin` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `*`.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –ü–†–û–í–ï–†–ö–ê**

---

## –ù–∏–∑–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ / –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 5. üîµ –ù–ò–ó–ö–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å:

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ IP –∞–¥—Ä–µ—Å–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –Ω–µ—É–¥–∞—á–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** üí° **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

---

### 6. üîµ –ù–ò–ó–ö–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ refresh token

**–§–∞–π–ª:** `src/api/auth/services/currentUser.service.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** Refresh token –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —Ñ–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ refresh token.

**–°—Ç–∞—Ç—É—Å:** üí° **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

---

### 7. üîµ –ù–ò–ó–ö–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ MongoDB

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ MongoDB —Å–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –Ω–∞:

- `email` –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `players` (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞)
- `accessToken` –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `sessions` (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞)
- `refreshToken` –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `sessions`

–≠—Ç–æ —É–ª—É—á—à–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

**–°—Ç–∞—Ç—É—Å:** üí° **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è email, –ø–∞—Ä–æ–ª—è, ObjectId, –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### ‚úÖ Rate Limiting

- –°—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: 5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 15 –º–∏–Ω—É—Ç
- –û–±—â–∏–π –ª–∏–º–∏—Ç –¥–ª—è –≤—Å–µ—Ö API: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –ó–∞—â–∏—Ç–∞ –æ—Ç brute-force –∏ DoS –∞—Ç–∞–∫

### ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DoS

- –õ–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ JSON payload: 10mb
- Rate limiting –Ω–∞ –≤—Å–µ—Ö endpoints

### ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `req.user` –≤–º–µ—Å—Ç–æ `req.body.user`
- –¢–∏–ø–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ TypeScript declaration merging
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞ –≤ `initUser`
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å–µ—Å—Å–∏–∏

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ production
- Stack traces –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ production
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥–∏

### ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å (–∫—Ä–æ–º–µ –∞–¥–º–∏–Ω–æ–≤)
- –Ø–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —É–ª—É—á—à–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–í—ã—Å–æ–∫–∏–π - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):

1. üü† –î–æ–±–∞–≤–∏—Ç—å security headers (helmet.js)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–°—Ä–µ–¥–Ω–∏–π - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–ª–∏–∑–µ):

2. üü° –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è login (timing attack)
3. üü° –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies)
4. üü° –ò—Å–ø—Ä–∞–≤–∏—Ç—å CORS credentials (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è cookies)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ù–∏–∑–∫–∏–π - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏):

5. üîµ –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
6. üîµ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é refresh token
7. üîµ –£–±–µ–¥–∏—Ç—å—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ –∏–Ω–¥–µ–∫—Å–æ–≤ MongoDB

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (`npm audit`) - **0 –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é MongoDB (–∏–Ω–¥–µ–∫—Å—ã, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞)
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ)
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- SSL/TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 0 ‚úÖ (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
- **–í—ã—Å–æ–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 1 (security headers)
- **–°—Ä–µ–¥–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 3 (timing attack, CSRF, CORS)
- **–ù–∏–∑–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ / –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** 3
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 11

**–û–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** ‚úÖ **–•–û–†–û–®–ò–ô** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ security headers)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –≤—ã—Å–æ–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –°–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç:

- ‚úÖ –ù–∞–¥–µ–∂–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç—É –æ—Ç brute-force –∏ DoS –∞—Ç–∞–∫
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å security headers (helmet.js) –¥–ª—è –ø–æ–ª–Ω–æ–π –∑–∞—â–∏—Ç—ã –æ—Ç –≤–µ–±-–∞—Ç–∞–∫ –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ timing attack –≤ login –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è enumeration –∞—Ç–∞–∫.
